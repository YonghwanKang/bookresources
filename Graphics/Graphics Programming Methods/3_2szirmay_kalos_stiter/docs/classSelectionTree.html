<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SelectionTree class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc2 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>SelectionTree Class Reference</h1><code>#include &lt;<a class="el" href="SelectionTree_8hpp-source.html">SelectionTree.hpp</a>&gt;</code>
<p>
Inheritance diagram for SelectionTree:<p><center><img src="classSelectionTree__inherit__graph.png" border="0" usemap="#SelectionTree__inherit__map" alt="Inheritance graph"></center>
<map name="SelectionTree__inherit__map">
<area href="classImportanceTree.html" shape="rect" coords="7,85,108,107" alt="">
<area href="classPowerTree.html" shape="rect" coords="132,85,204,107" alt="">
</map>
<center><font size="2">[<a href="graph_legend.html">legend</a>]</font></center>Collaboration diagram for SelectionTree:<p><center><img src="classSelectionTree__coll__graph.png" border="0" usemap="#SelectionTree__coll__map" alt="Collaboration graph"></center>
<map name="SelectionTree__coll__map">
<area href="classPatch.html" shape="rect" coords="35,755,77,776" alt="">
<area href="classTriangle.html" shape="rect" coords="140,683,199,704" alt="">
<area href="classIntersectable.html" shape="rect" coords="319,592,401,613" alt="">
<area href="classHitRec.html" shape="rect" coords="429,683,477,704" alt="">
<area href="classMaterial.html" shape="rect" coords="321,333,377,355" alt="">
<area href="classCPhongEdf.html" shape="rect" coords="207,187,284,208" alt="">
<area href="classVector.html" shape="rect" coords="244,16,292,37" alt="">
<area href="classCPhongBrdf.html" shape="rect" coords="308,187,391,208" alt="">
<area href="classBoundingBox.html" shape="rect" coords="471,232,556,253" alt="">
<area href="classTreeElement.html" shape="rect" coords="181,755,267,776" alt="">
</map>
<center><font size="2">[<a href="graph_legend.html">legend</a>]</font></center><a href="classSelectionTree-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Public Methods</h2></td></tr>
<tr><td nowrap align=right valign=top>&nbsp;</td><td valign=bottom><a class="el" href="classSelectionTree.html#a0">SelectionTree</a> ()</td></tr>
<tr><td nowrap align=right valign=top>&nbsp;</td><td valign=bottom><a class="el" href="classSelectionTree.html#a1">~SelectionTree</a> ()</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="classSelectionTree.html#a2">Build</a> (<a class="el" href="classPatch.html">Patch</a> *scenePatches, long nScenePatches)</td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="classSelectionTree.html#a3">Update</a> (long index)</td></tr>
<tr><td nowrap align=right valign=top>long&nbsp;</td><td valign=bottom><a class="el" href="classSelectionTree.html#a4">FindDistrib</a> (float p, long nIteration)</td></tr>
<tr><td nowrap align=right valign=top>virtual void&nbsp;</td><td valign=bottom><a class="el" href="classSelectionTree.html#a5">fillElement</a> (long patchIndex, <a class="el" href="classTreeElement.html">TreeElement</a> &amp;t)=0</td></tr>
<tr><td nowrap align=right valign=top>float&nbsp;</td><td valign=bottom><a class="el" href="classSelectionTree.html#a6">getValue</a> (const <a class="el" href="classTreeElement.html">TreeElement</a> &amp;t, long nIteration)</td></tr>
<tr><td nowrap align=right valign=top>float&nbsp;</td><td valign=bottom><a class="el" href="classSelectionTree.html#a7">getValue2</a> (long patchIndex, long nIteration)</td></tr>
<tr><td nowrap align=right valign=top>float&nbsp;</td><td valign=bottom><a class="el" href="classSelectionTree.html#a8">getRootValue</a> (long nIteration)</td></tr>
<tr><td colspan=2><br><h2>Protected Attributes</h2></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="classTreeElement.html">TreeElement</a> *&nbsp;</td><td valign=bottom><a class="el" href="classSelectionTree.html#n0">m_TreeElements</a></td></tr>
<tr><td nowrap align=right valign=top>long&nbsp;</td><td valign=bottom><a class="el" href="classSelectionTree.html#n1">m_nElements</a></td></tr>
<tr><td nowrap align=right valign=top>long&nbsp;</td><td valign=bottom><a class="el" href="classSelectionTree.html#n2">m_nScenePatches</a></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="classPatch.html">Patch</a> *&nbsp;</td><td valign=bottom><a class="el" href="classSelectionTree.html#n3">m_pScenePatches</a></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
SelectionTree allows radiance/importance-based patch selection and update in O(log n) 
<p>

<p>
Definition at line <a class="el" href="SelectionTree_8hpp-source.html#l00026">26</a> of file <a class="el" href="SelectionTree_8hpp-source.html">SelectionTree.hpp</a>.<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a name="a0" doxytag="SelectionTree::SelectionTree"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> SelectionTree::SelectionTree </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="SelectionTree_8cpp-source.html#l00005">5</a> of file <a class="el" href="SelectionTree_8cpp-source.html">SelectionTree.cpp</a>.
<p>
References <a class="el" href="SelectionTree_8hpp-source.html#l00029">m_nElements</a>, <a class="el" href="SelectionTree_8hpp-source.html#l00031">m_nScenePatches</a>, <a class="el" href="SelectionTree_8hpp-source.html#l00032">m_pScenePatches</a>, and <a class="el" href="SelectionTree_8hpp-source.html#l00028">m_TreeElements</a>.
<p>
<div class="fragment"><pre>00005                              {  
00006         <a class="code" href="classSelectionTree.html#n3">m_pScenePatches</a> = NULL;
00007         <a class="code" href="classSelectionTree.html#n0">m_TreeElements</a> = NULL;
00008 
00009         <a class="code" href="classSelectionTree.html#n2">m_nScenePatches</a> = <a class="code" href="classSelectionTree.html#n1">m_nElements</a> = 0;
00010 }
</pre></div>    </td>
  </tr>
</table>
<a name="a1" doxytag="SelectionTree::~SelectionTree"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> SelectionTree::~SelectionTree </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="SelectionTree_8cpp-source.html#l00013">13</a> of file <a class="el" href="SelectionTree_8cpp-source.html">SelectionTree.cpp</a>.
<p>
References <a class="el" href="SelectionTree_8hpp-source.html#l00028">m_TreeElements</a>.
<p>
<div class="fragment"><pre>00014 {
00015         <span class="keywordflow">if</span> (m_TreeElements)
00016                 <span class="keyword">delete</span> <a class="code" href="classSelectionTree.html#n0">m_TreeElements</a>;
00017 }
</pre></div>    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a name="a2" doxytag="SelectionTree::Build"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void SelectionTree::Build </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classPatch.html">Patch</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>scenePatches</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>nScenePatches</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="SelectionTree_8cpp-source.html#l00020">20</a> of file <a class="el" href="SelectionTree_8cpp-source.html">SelectionTree.cpp</a>.
<p>
References <a class="el" href="SelectionTree_8hpp-source.html#l00021">TreeElement::clear()</a>, <a class="el" href="classSelectionTree.html#a5">fillElement()</a>, <a class="el" href="SelectionTree_8hpp-source.html#l00029">m_nElements</a>, <a class="el" href="SelectionTree_8hpp-source.html#l00031">m_nScenePatches</a>, <a class="el" href="SelectionTree_8hpp-source.html#l00032">m_pScenePatches</a>, and <a class="el" href="SelectionTree_8hpp-source.html#l00028">m_TreeElements</a>.
<p>
Referenced by <a class="el" href="StIter_8cpp-source.html#l00360">StIter::render()</a>.
<p>
<div class="fragment"><pre>00021 {
00022         <a class="code" href="classSelectionTree.html#n2">m_nScenePatches</a> = nScenePatches;
00023         <a class="code" href="classSelectionTree.html#n3">m_pScenePatches</a> = scenePatches;
00024 
00025         <span class="comment">// calculate the depth of the tree</span>
00026     <span class="keywordtype">long</span> j=<a class="code" href="classSelectionTree.html#n2">m_nScenePatches</a>;
00027         <span class="keywordtype">long</span> log2=0;
00028         <span class="keywordflow">while</span> (j &gt;0) {
00029                 log2++;
00030                 j=j&gt;&gt;1;
00031         }
00032 
00033         <span class="keywordtype">long</span> elements = (1 &lt;&lt; log2) -1;
00034         <span class="keywordflow">if</span> (<a class="code" href="classSelectionTree.html#n1">m_nElements</a>!=elements) {
00035                 <span class="keywordflow">if</span> (m_TreeElements) 
00036                         <span class="keyword">delete</span> <a class="code" href="classSelectionTree.html#n0">m_TreeElements</a>;
00037                 <a class="code" href="classSelectionTree.html#n1">m_nElements</a>=elements;
00038                 m_TreeElements = <span class="keyword">new</span> <a class="code" href="classTreeElement.html">TreeElement</a>[<a class="code" href="classSelectionTree.html#n1">m_nElements</a>];
00039         }
00040 
00041         <span class="comment">//reset the array by clearing the elements</span>
00042         <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="classSelectionTree.html#n1">m_nElements</a>; i++) {
00043                 <a class="code" href="classSelectionTree.html#n0">m_TreeElements</a>[i].<a class="code" href="classTreeElement.html#a5">clear</a>();
00044         };
00045 
00046         <span class="keywordtype">long</span> k=(1&lt;&lt;(log2-1))-1;
00047 
00048         <a class="code" href="classTreeElement.html">TreeElement</a> tmp1, tmp2;
00049         <span class="comment">// calculate the leaves of the tree based on the patches</span>
00050         <span class="keywordflow">for</span> (i=0; i&lt;m_nScenePatches; i+=2) {
00051                 <span class="keywordflow">if</span> (i&lt;m_nScenePatches) {
00052                         <a class="code" href="classSelectionTree.html#a5">fillElement</a>(i, tmp1);
00053                 } <span class="keywordflow">else</span> {
00054                         tmp1.<a class="code" href="classTreeElement.html#a5">clear</a>();
00055                 }
00056 
00057                 <span class="keywordflow">if</span> (i+1&lt;m_nScenePatches) {
00058                         <a class="code" href="classSelectionTree.html#a5">fillElement</a>(i+1, tmp2);
00059                 } <span class="keywordflow">else</span> {
00060                         tmp2.<a class="code" href="classTreeElement.html#a5">clear</a>();
00061                 }
00062                 <a class="code" href="classSelectionTree.html#n0">m_TreeElements</a>[k++] = tmp1+tmp2;
00063         }
00064 
00065         <span class="comment">// the leaves are done, build the tree!</span>
00066         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l=log2-2; l&gt;=0; l--) {
00067                 <span class="keywordtype">long</span> start=(1&lt;&lt;l)-1;
00068                 <span class="keywordtype">long</span> end=(1&lt;&lt;(l+1))-1;
00069 
00070                 <span class="keywordflow">for</span> (<span class="keywordtype">long</span> m=start; m&lt;end; m++) {
00071                         <a class="code" href="classSelectionTree.html#n0">m_TreeElements</a>[m] = <a class="code" href="classSelectionTree.html#n0">m_TreeElements</a>[(m&lt;&lt;1)+1] + m_TreeElements[(m&lt;&lt;1)+2];
00072                 }
00073         }
00074 }
</pre></div>    </td>
  </tr>
</table>
<a name="a5" doxytag="SelectionTree::fillElement"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> virtual void SelectionTree::fillElement </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">long&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>patchIndex</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classTreeElement.html">TreeElement</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>t</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [pure virtual]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Implemented in <a class="el" href="classPowerTree.html#a0">PowerTree</a>, and <a class="el" href="classImportanceTree.html#a0">ImportanceTree</a>.
<p>
Referenced by <a class="el" href="SelectionTree_8cpp-source.html#l00020">Build()</a>, <a class="el" href="SelectionTree_8hpp-source.html#l00048">getValue2()</a>, and <a class="el" href="SelectionTree_8cpp-source.html#l00077">Update()</a>.    </td>
  </tr>
</table>
<a name="a4" doxytag="SelectionTree::FindDistrib"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long SelectionTree::FindDistrib </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">float&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>p</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>nIteration</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="SelectionTree_8cpp-source.html#l00105">105</a> of file <a class="el" href="SelectionTree_8cpp-source.html">SelectionTree.cpp</a>.
<p>
References <a class="el" href="SelectionTree_8hpp-source.html#l00054">getRootValue()</a>, <a class="el" href="SelectionTree_8hpp-source.html#l00044">getValue()</a>, <a class="el" href="SelectionTree_8hpp-source.html#l00048">getValue2()</a>, <a class="el" href="SelectionTree_8hpp-source.html#l00029">m_nElements</a>, and <a class="el" href="SelectionTree_8hpp-source.html#l00031">m_nScenePatches</a>.
<p>
Referenced by <a class="el" href="StIter_8cpp-source.html#l00411">StIter::DoIteration()</a>.
<p>
<div class="fragment"><pre>00106 {
00107         p*=<a class="code" href="classSelectionTree.html#a8">getRootValue</a>(nIteration);
00108 
00109         <span class="comment">// indx points to the left leaf</span>
00110         <span class="keywordflow">for</span> (<span class="keywordtype">long</span> indx = 1; indx&lt;<a class="code" href="classSelectionTree.html#n1">m_nElements</a>; indx = (indx&lt;&lt;1)+1) {
00111                 <span class="keyword">const</span> <span class="keywordtype">float</span> left=<a class="code" href="classSelectionTree.html#a6">getValue</a>(m_TreeElements[indx], nIteration);
00112                 <span class="keywordflow">if</span> (p&gt;left) {
00113                         <span class="comment">// go right</span>
00114                         indx++;
00115                         p-=left;
00116                 }
00117         }
00118 
00119         <span class="keywordtype">long</span> l=indx-m_nElements;
00120         <span class="keywordflow">if</span> (l&gt;=<a class="code" href="classSelectionTree.html#n2">m_nScenePatches</a>) 
00121                 <span class="keywordflow">return</span> <a class="code" href="classSelectionTree.html#n2">m_nScenePatches</a>-1;
00122 
00123         <span class="comment">//End of the tree; check the 2 leaves</span>
00124         <span class="comment">//i.e. check the left. If it is too small, pick the right one</span>
00125         <span class="keywordflow">if</span> (p &gt; <a class="code" href="classSelectionTree.html#a7">getValue2</a>(l, nIteration)) l++;
00126         <span class="keywordflow">if</span> (l&gt;=<a class="code" href="classSelectionTree.html#n2">m_nScenePatches</a>) 
00127                 <span class="keywordflow">return</span> <a class="code" href="classSelectionTree.html#n2">m_nScenePatches</a>-1;
00128         <span class="keywordflow">else</span> <span class="keywordflow">return</span> l;
00129 }
</pre></div>    </td>
  </tr>
</table>
<a name="a8" doxytag="SelectionTree::getRootValue"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> float SelectionTree::getRootValue </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">long&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>nIteration</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="SelectionTree_8hpp-source.html#l00054">54</a> of file <a class="el" href="SelectionTree_8hpp-source.html">SelectionTree.hpp</a>.
<p>
References <a class="el" href="SelectionTree_8hpp-source.html#l00044">getValue()</a>.
<p>
Referenced by <a class="el" href="StIter_8cpp-source.html#l00411">StIter::DoIteration()</a>, and <a class="el" href="SelectionTree_8cpp-source.html#l00105">FindDistrib()</a>.
<p>
<div class="fragment"><pre>00054 { <span class="keywordflow">return</span> <a class="code" href="classSelectionTree.html#a6">getValue</a>(m_TreeElements[0], nIteration); }
</pre></div>    </td>
  </tr>
</table>
<a name="a6" doxytag="SelectionTree::getValue"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> float SelectionTree::getValue </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="classTreeElement.html">TreeElement</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>t</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>nIteration</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="SelectionTree_8hpp-source.html#l00044">44</a> of file <a class="el" href="SelectionTree_8hpp-source.html">SelectionTree.hpp</a>.
<p>
References <a class="el" href="SelectionTree_8hpp-source.html#l00009">TreeElement::emitted</a>, and <a class="el" href="SelectionTree_8hpp-source.html#l00009">TreeElement::reflected</a>.
<p>
Referenced by <a class="el" href="SelectionTree_8cpp-source.html#l00105">FindDistrib()</a>, <a class="el" href="SelectionTree_8hpp-source.html#l00054">getRootValue()</a>, and <a class="el" href="SelectionTree_8hpp-source.html#l00048">getValue2()</a>.
<p>
<div class="fragment"><pre>00044                                                               {
00045                 <span class="keywordflow">return</span> t.<a class="code" href="classTreeElement.html#m0">emitted</a> + t.<a class="code" href="classTreeElement.html#m1">reflected</a>/(float)nIteration;
00046         }
</pre></div>    </td>
  </tr>
</table>
<a name="a7" doxytag="SelectionTree::getValue2"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> float SelectionTree::getValue2 </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">long&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>patchIndex</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>nIteration</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [inline]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="SelectionTree_8hpp-source.html#l00048">48</a> of file <a class="el" href="SelectionTree_8hpp-source.html">SelectionTree.hpp</a>.
<p>
References <a class="el" href="classSelectionTree.html#a5">fillElement()</a>, and <a class="el" href="SelectionTree_8hpp-source.html#l00044">getValue()</a>.
<p>
Referenced by <a class="el" href="StIter_8cpp-source.html#l00411">StIter::DoIteration()</a>, and <a class="el" href="SelectionTree_8cpp-source.html#l00105">FindDistrib()</a>.
<p>
<div class="fragment"><pre>00048                                                           {
00049                 <a class="code" href="classTreeElement.html">TreeElement</a> t;
00050                 <a class="code" href="classSelectionTree.html#a5">fillElement</a>(patchIndex, t);
00051                 <span class="keywordflow">return</span> <a class="code" href="classSelectionTree.html#a6">getValue</a>(t, nIteration);
00052         };
</pre></div>    </td>
  </tr>
</table>
<a name="a3" doxytag="SelectionTree::Update"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void SelectionTree::Update </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">long&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>index</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="SelectionTree_8cpp-source.html#l00077">77</a> of file <a class="el" href="SelectionTree_8cpp-source.html">SelectionTree.cpp</a>.
<p>
References <a class="el" href="SelectionTree_8hpp-source.html#l00021">TreeElement::clear()</a>, <a class="el" href="classSelectionTree.html#a5">fillElement()</a>, <a class="el" href="SelectionTree_8hpp-source.html#l00029">m_nElements</a>, <a class="el" href="SelectionTree_8hpp-source.html#l00031">m_nScenePatches</a>, and <a class="el" href="SelectionTree_8hpp-source.html#l00028">m_TreeElements</a>.
<p>
Referenced by <a class="el" href="StIter_8cpp-source.html#l00411">StIter::DoIteration()</a>.
<p>
<div class="fragment"><pre>00078 {
00079         <span class="keywordtype">long</span> l=(<a class="code" href="classSelectionTree.html#n1">m_nElements</a>+index-1)&gt;&gt;1;
00080         <span class="keywordtype">long</span> index2 = index + ( index%2==0 ? 1 : -1 );
00081 
00082         <a class="code" href="classTreeElement.html">TreeElement</a> tmp1, tmp2;
00083         <span class="keywordflow">if</span> (index&lt;<a class="code" href="classSelectionTree.html#n2">m_nScenePatches</a>) {
00084                 <a class="code" href="classSelectionTree.html#a5">fillElement</a>(index, tmp1);
00085         } <span class="keywordflow">else</span> {
00086                 tmp1.<a class="code" href="classTreeElement.html#a5">clear</a>();
00087         }
00088 
00089         <span class="keywordflow">if</span> (index2&lt;<a class="code" href="classSelectionTree.html#n2">m_nScenePatches</a>) {
00090                 <a class="code" href="classSelectionTree.html#a5">fillElement</a>(index2, tmp2);
00091         } <span class="keywordflow">else</span> {
00092                 tmp2.<a class="code" href="classTreeElement.html#a5">clear</a>();
00093         }
00094 
00095         <span class="comment">// calculate the leaf</span>
00096         <a class="code" href="classSelectionTree.html#n0">m_TreeElements</a>[l] = tmp1+tmp2;
00097 
00098         <span class="comment">// propagate the value up to the root</span>
00099         <span class="keywordflow">for</span> (l=(l-1)&gt;&gt;1; l&gt;=0; l=(l-1)&gt;&gt;1) {
00100                 <a class="code" href="classSelectionTree.html#n0">m_TreeElements</a>[l]=<a class="code" href="classSelectionTree.html#n0">m_TreeElements</a>[(l&lt;&lt;1)+1]+m_TreeElements[(l&lt;&lt;1)+2];
00101         }
00102 }
</pre></div>    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a name="n1" doxytag="SelectionTree::m_nElements"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long SelectionTree::m_nElements<code> [protected]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="SelectionTree_8hpp-source.html#l00029">29</a> of file <a class="el" href="SelectionTree_8hpp-source.html">SelectionTree.hpp</a>.
<p>
Referenced by <a class="el" href="SelectionTree_8cpp-source.html#l00020">Build()</a>, <a class="el" href="SelectionTree_8cpp-source.html#l00105">FindDistrib()</a>, <a class="el" href="SelectionTree_8cpp-source.html#l00005">SelectionTree()</a>, and <a class="el" href="SelectionTree_8cpp-source.html#l00077">Update()</a>.    </td>
  </tr>
</table>
<a name="n2" doxytag="SelectionTree::m_nScenePatches"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> long SelectionTree::m_nScenePatches<code> [protected]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="SelectionTree_8hpp-source.html#l00031">31</a> of file <a class="el" href="SelectionTree_8hpp-source.html">SelectionTree.hpp</a>.
<p>
Referenced by <a class="el" href="SelectionTree_8cpp-source.html#l00020">Build()</a>, <a class="el" href="SelectionTree_8cpp-source.html#l00105">FindDistrib()</a>, <a class="el" href="SelectionTree_8cpp-source.html#l00005">SelectionTree()</a>, and <a class="el" href="SelectionTree_8cpp-source.html#l00077">Update()</a>.    </td>
  </tr>
</table>
<a name="n3" doxytag="SelectionTree::m_pScenePatches"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="classPatch.html">Patch</a>* SelectionTree::m_pScenePatches<code> [protected]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="SelectionTree_8hpp-source.html#l00032">32</a> of file <a class="el" href="SelectionTree_8hpp-source.html">SelectionTree.hpp</a>.
<p>
Referenced by <a class="el" href="SelectionTree_8cpp-source.html#l00020">Build()</a>, <a class="el" href="SelectionTree_8cpp-source.html#l00150">ImportanceTree::fillElement()</a>, <a class="el" href="SelectionTree_8cpp-source.html#l00134">PowerTree::fillElement()</a>, and <a class="el" href="SelectionTree_8cpp-source.html#l00005">SelectionTree()</a>.    </td>
  </tr>
</table>
<a name="n0" doxytag="SelectionTree::m_TreeElements"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="classTreeElement.html">TreeElement</a>* SelectionTree::m_TreeElements<code> [protected]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="SelectionTree_8hpp-source.html#l00028">28</a> of file <a class="el" href="SelectionTree_8hpp-source.html">SelectionTree.hpp</a>.
<p>
Referenced by <a class="el" href="SelectionTree_8cpp-source.html#l00020">Build()</a>, <a class="el" href="SelectionTree_8cpp-source.html#l00005">SelectionTree()</a>, <a class="el" href="SelectionTree_8cpp-source.html#l00077">Update()</a>, and <a class="el" href="SelectionTree_8cpp-source.html#l00013">~SelectionTree()</a>.    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="SelectionTree_8hpp-source.html">SelectionTree.hpp</a><li><a class="el" href="SelectionTree_8cpp-source.html">SelectionTree.cpp</a></ul>
<hr><address style="align: right;"><small>Generated on Tue Feb 18 18:30:51 2003 for Stochastic Iteration for Non-diffuse Global Illumination by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc2 </small></address>
</body>
</html>
