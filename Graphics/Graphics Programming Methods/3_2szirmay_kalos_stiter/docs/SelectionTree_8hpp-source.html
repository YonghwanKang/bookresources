<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>SelectionTree.hpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc2 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>SelectionTree.hpp</h1><a href="SelectionTree_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#pragma once</span>
00002 <span class="preprocessor"></span>
00003 <span class="preprocessor">#include "<a class="code" href="scene_8hpp.html">scene.hpp</a>"</span>
00004 <span class="comment"></span>
00005 <span class="comment">//! TreeElement class will be the element of the SelectionTree,</span>
00006 <span class="comment">//! allowing radiance/importance-based patch selection</span>
<a name="l00007"></a><a class="code" href="classTreeElement.html">00007</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="classTreeElement.html">TreeElement</a> {
00008 <span class="keyword">public</span>:
<a name="l00009"></a><a class="code" href="classTreeElement.html#m1">00009</a>         <span class="keywordtype">float</span> <a class="code" href="classTreeElement.html#m0">emitted</a>, <a class="code" href="classTreeElement.html#m1">reflected</a>;
<a name="l00010"></a><a class="code" href="classTreeElement.html#a0">00010</a>         <a class="code" href="classTreeElement.html#a0">TreeElement</a>() {};
<a name="l00011"></a><a class="code" href="classTreeElement.html#a1">00011</a>         <a class="code" href="classTreeElement.html#a0">TreeElement</a>(<span class="keywordtype">float</span> e, <span class="keywordtype">float</span> r) : emitted(e), reflected(r) {};
<a name="l00012"></a><a class="code" href="classTreeElement.html#a2">00012</a>         <span class="keywordtype">void</span> <a class="code" href="classTreeElement.html#a2">set</a>(<span class="keywordtype">float</span> e, <span class="keywordtype">float</span> r) { emitted=e; reflected=r; };
<a name="l00013"></a><a class="code" href="classTreeElement.html#a3">00013</a>         <a class="code" href="classTreeElement.html">TreeElement</a> <a class="code" href="classTreeElement.html#a3">operator+</a>(<span class="keyword">const</span> <a class="code" href="classTreeElement.html">TreeElement</a>&amp; o)<span class="keyword"> const </span>{
00014                 <span class="keywordflow">return</span> <a class="code" href="classTreeElement.html#a0">TreeElement</a>(emitted+o.<a class="code" href="classTreeElement.html#m0">emitted</a>, reflected+o.<a class="code" href="classTreeElement.html#m1">reflected</a>);
00015         }
<a name="l00016"></a><a class="code" href="classTreeElement.html#a4">00016</a>         <span class="keyword">const</span> <a class="code" href="classTreeElement.html">TreeElement</a>&amp; <a class="code" href="classTreeElement.html#a4">operator=</a>(<span class="keyword">const</span> <a class="code" href="classTreeElement.html">TreeElement</a>&amp; o) {
00017                 emitted=o.<a class="code" href="classTreeElement.html#m0">emitted</a>;
00018                 reflected=o.<a class="code" href="classTreeElement.html#m1">reflected</a>;
00019                 <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00020         }
<a name="l00021"></a><a class="code" href="classTreeElement.html#a5">00021</a>         <span class="keywordtype">void</span> <a class="code" href="classTreeElement.html#a5">clear</a>() { emitted = reflected =0.0f; };
00022 };
00023 <span class="comment"></span>
00024 <span class="comment">//! SelectionTree allows radiance/importance-based </span>
00025 <span class="comment">//! patch selection and update in O(log n)</span>
<a name="l00026"></a><a class="code" href="classSelectionTree.html">00026</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="classSelectionTree.html">SelectionTree</a> {
00027 <span class="keyword">protected</span>:
<a name="l00028"></a><a class="code" href="classSelectionTree.html#n0">00028</a>         <a class="code" href="classTreeElement.html">TreeElement</a>* <a class="code" href="classSelectionTree.html#n0">m_TreeElements</a>;
<a name="l00029"></a><a class="code" href="classSelectionTree.html#n1">00029</a>         <span class="keywordtype">long</span> <a class="code" href="classSelectionTree.html#n1">m_nElements</a>;
00030 
<a name="l00031"></a><a class="code" href="classSelectionTree.html#n2">00031</a>         <span class="keywordtype">long</span> <a class="code" href="classSelectionTree.html#n2">m_nScenePatches</a>;
<a name="l00032"></a><a class="code" href="classSelectionTree.html#n3">00032</a>         <a class="code" href="classPatch.html">Patch</a>* <a class="code" href="classSelectionTree.html#n3">m_pScenePatches</a>;
00033 
00034 <span class="keyword">public</span>:
00035         <a class="code" href="classSelectionTree.html#a0">SelectionTree</a>();
00036         <a class="code" href="classSelectionTree.html#a1">~SelectionTree</a>();
00037 
00038         <span class="keywordtype">void</span> <a class="code" href="classSelectionTree.html#a2">Build</a>(<a class="code" href="classPatch.html">Patch</a>* scenePatches, <span class="keywordtype">long</span> nScenePatches);
00039         <span class="keywordtype">void</span> <a class="code" href="classSelectionTree.html#a3">Update</a>(<span class="keywordtype">long</span> index);
00040         <span class="keywordtype">long</span> <a class="code" href="classSelectionTree.html#a4">FindDistrib</a>(<span class="keywordtype">float</span> p, <span class="keywordtype">long</span> nIteration);
00041 
00042         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classSelectionTree.html#a5">fillElement</a>(<span class="keywordtype">long</span> patchIndex, <a class="code" href="classTreeElement.html">TreeElement</a>&amp; t)=0;
00043         
<a name="l00044"></a><a class="code" href="classSelectionTree.html#a6">00044</a>         <span class="keywordtype">float</span> <a class="code" href="classSelectionTree.html#a6">getValue</a>(<span class="keyword">const</span> <a class="code" href="classTreeElement.html">TreeElement</a>&amp; t, <span class="keywordtype">long</span> nIteration) {
00045                 <span class="keywordflow">return</span> t.<a class="code" href="classTreeElement.html#m0">emitted</a> + t.<a class="code" href="classTreeElement.html#m1">reflected</a>/(float)nIteration;
00046         }
00047 
<a name="l00048"></a><a class="code" href="classSelectionTree.html#a7">00048</a>         <span class="keywordtype">float</span> <a class="code" href="classSelectionTree.html#a7">getValue2</a>(<span class="keywordtype">long</span> patchIndex, <span class="keywordtype">long</span> nIteration) {
00049                 <a class="code" href="classTreeElement.html">TreeElement</a> t;
00050                 <a class="code" href="classSelectionTree.html#a5">fillElement</a>(patchIndex, t);
00051                 <span class="keywordflow">return</span> <a class="code" href="classSelectionTree.html#a6">getValue</a>(t, nIteration);
00052         };
00053 
<a name="l00054"></a><a class="code" href="classSelectionTree.html#a8">00054</a>         <span class="keywordtype">float</span> <a class="code" href="classSelectionTree.html#a8">getRootValue</a>(<span class="keywordtype">long</span> nIteration) { <span class="keywordflow">return</span> <a class="code" href="classSelectionTree.html#a6">getValue</a>(m_TreeElements[0], nIteration); }
00055 };
00056 
<a name="l00057"></a><a class="code" href="classPowerTree.html">00057</a> <span class="keyword">class </span><a class="code" href="classPowerTree.html">PowerTree</a> : <span class="keyword">public</span> <a class="code" href="classSelectionTree.html">SelectionTree</a> {
00058 <span class="keyword">public</span>:
00059         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classPowerTree.html#a0">fillElement</a>(<span class="keywordtype">long</span> patchIndex, <a class="code" href="classTreeElement.html">TreeElement</a>&amp; t);
00060 };
00061 
00062 
<a name="l00063"></a><a class="code" href="classImportanceTree.html">00063</a> <span class="keyword">class </span><a class="code" href="classImportanceTree.html">ImportanceTree</a> : <span class="keyword">public</span> <a class="code" href="classSelectionTree.html">SelectionTree</a> {
00064 <span class="keyword">public</span>:
00065         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classImportanceTree.html#a0">fillElement</a>(<span class="keywordtype">long</span> patchIndex, <a class="code" href="classTreeElement.html">TreeElement</a>&amp; t);
00066 };
00067 
</pre></div><hr><address style="align: right;"><small>Generated on Tue Feb 18 18:30:34 2003 for Stochastic Iteration for Non-diffuse Global Illumination by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc2 </small></address>
</body>
</html>
