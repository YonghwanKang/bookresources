<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>World.hpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc2 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>World.hpp</h1><a href="World_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#pragma once</span>
00002 <span class="preprocessor"></span>
00003 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00004 <span class="preprocessor">#include &lt;float.h&gt;</span>
00005 <span class="preprocessor">#include &lt;math.h&gt;</span>
00006 
00007 <span class="preprocessor">#include "vector.hpp"</span>
00008 <span class="comment"></span>
00009 <span class="comment">//! Defining a ray with its origin and direction</span>
<a name="l00010"></a><a class="code" href="classRay.html">00010</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="classRay.html">Ray</a> {
00011 <span class="keyword">public</span>:<span class="comment"></span>
00012 <span class="comment">        //! origin of the ray</span>
<a name="l00013"></a><a class="code" href="classRay.html#m0">00013</a> <span class="comment"></span>        <a class="code" href="classVector.html">Vector</a> <a class="code" href="classRay.html#m0">origin</a>;
00014         <span class="comment"></span>
00015 <span class="comment">        //! must be normalised</span>
<a name="l00016"></a><a class="code" href="classRay.html#m1">00016</a> <span class="comment"></span>        <a class="code" href="classVector.html">Vector</a> <a class="code" href="classRay.html#m1">dir</a>;             
00017 <span class="comment"></span>
00018 <span class="comment">        //! must be initialised and unique for each search call to the KD tree data structure</span>
<a name="l00019"></a><a class="code" href="classRay.html#m2">00019</a> <span class="comment"></span>        <span class="keywordtype">long</span> <a class="code" href="classRay.html#m2">id</a>;                
00020 <span class="comment"></span>
00021 <span class="comment">        //! global static variable, aiding unique ID generation</span>
00022 <span class="comment"></span>        <span class="keyword">static</span> <span class="keywordtype">long</span> <a class="code" href="classRay.html#p0">maxRayID</a>;
00023 };
00024 <span class="comment"></span>
00025 <span class="comment">//! Axis-aligned bounding box used in kd-tree</span>
<a name="l00026"></a><a class="code" href="classBoundingBox.html">00026</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="classBoundingBox.html">BoundingBox</a> {             
00027 <span class="keyword">public</span>:
<a name="l00028"></a><a class="code" href="classBoundingBox.html#m0">00028</a>         <a class="code" href="classVector.html">Vector</a> <a class="code" href="classBoundingBox.html#m0">minPoint</a>;
<a name="l00029"></a><a class="code" href="classBoundingBox.html#m1">00029</a>         <a class="code" href="classVector.html">Vector</a> <a class="code" href="classBoundingBox.html#m1">maxPoint</a>;
00030 
00031         <span class="comment">// returns the center of the BoundingBox</span>
<a name="l00032"></a><a class="code" href="classBoundingBox.html#a0">00032</a>         <a class="code" href="classVector.html">Vector</a> <a class="code" href="classBoundingBox.html#a0">Center</a> (<span class="keywordtype">void</span>) {
00033                 <a class="code" href="classVector.html">Vector</a> center;
00034                 center = (minPoint + maxPoint) * 0.5;
00035                 <span class="keywordflow">return</span> center;
00036         }
00037 };
00038 
00039 <span class="keyword">class </span><a class="code" href="classIntersectable.html">Intersectable</a>;
00040 <span class="comment"></span>
00041 <span class="comment">//! ray - object intersection test result</span>
<a name="l00042"></a><a class="code" href="classHitRec.html">00042</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="classHitRec.html">HitRec</a> {
00043 <span class="keyword">public</span>:<span class="comment"></span>
00044 <span class="comment">        //! point of the intersection</span>
<a name="l00045"></a><a class="code" href="classHitRec.html#m0">00045</a> <span class="comment"></span>        <a class="code" href="classVector.html">Vector</a>  <a class="code" href="classHitRec.html#m0">point</a>;                  
00046 <span class="comment"></span>
00047 <span class="comment">        //! distance from ray origin</span>
<a name="l00048"></a><a class="code" href="classHitRec.html#m1">00048</a> <span class="comment"></span>        <span class="keywordtype">float</span>   <a class="code" href="classHitRec.html#m1">depth</a>;                  
00049 <span class="comment"></span>
00050 <span class="comment">        //! object found </span>
<a name="l00051"></a><a class="code" href="classHitRec.html#m2">00051</a> <span class="comment"></span>        <a class="code" href="classIntersectable.html">Intersectable</a>* <a class="code" href="classHitRec.html#m2">object</a>;  
00052 <span class="comment"></span>
00053 <span class="comment">        //! valid flag</span>
<a name="l00054"></a><a class="code" href="classHitRec.html#m3">00054</a> <span class="comment"></span>        <span class="keywordtype">bool</span>    <a class="code" href="classHitRec.html#m3">isIntersect</a>;    
00055 <span class="comment"></span>
00056 <span class="comment">        //! default constructor</span>
<a name="l00057"></a><a class="code" href="classHitRec.html#a0">00057</a> <span class="comment"></span>        <a class="code" href="classHitRec.html#a0">HitRec</a>() { 
00058                 depth=0.0f;
00059         }
00060 };
00061 
00062 <span class="keyword">class </span><a class="code" href="classMaterial.html">Material</a>;
00063 <span class="comment"></span>
00064 <span class="comment">//! Defines the basic behaviour of an intersectable object to be stored in the KD tree</span>
<a name="l00065"></a><a class="code" href="classIntersectable.html">00065</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="classIntersectable.html">Intersectable</a> {
00066 <span class="keyword">public</span>:<span class="comment"></span>
00067 <span class="comment">        //! Material of the intersectable object</span>
<a name="l00068"></a><a class="code" href="classIntersectable.html#m0">00068</a> <span class="comment"></span>        <span class="keyword">const</span> <a class="code" href="classMaterial.html">Material</a>* <a class="code" href="classIntersectable.html#m0">m_pMaterial</a>;
00069 <span class="comment"></span>
00070 <span class="comment">        //! bounding box for the kd-tree</span>
<a name="l00071"></a><a class="code" href="classIntersectable.html#m1">00071</a> <span class="comment"></span>        <a class="code" href="classBoundingBox.html">BoundingBox</a>     <a class="code" href="classIntersectable.html#m1">bbox</a>;
00072 <span class="comment"></span>
00073 <span class="comment">        //! result of the last intersection test</span>
<a name="l00074"></a><a class="code" href="classIntersectable.html#m2">00074</a> <span class="comment"></span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    <a class="code" href="classIntersectable.html#m2">lastTestedRayId</a>;                
<a name="l00075"></a><a class="code" href="classIntersectable.html#m3">00075</a>         <a class="code" href="classHitRec.html">HitRec</a>                  <a class="code" href="classIntersectable.html#m3">lastTestedRayResult</a>;
00076 
00077 <span class="keyword">public</span>:
00078         <a class="code" href="classIntersectable.html#a0">Intersectable</a>(<span class="keyword">const</span> <a class="code" href="classMaterial.html">Material</a>* material);
00079         <a class="code" href="classIntersectable.html#a1">~Intersectable</a>();
00080         <span class="comment"></span>
00081 <span class="comment">        //! pure virtual function, must be implemented to carry out the intersection test</span>
00082 <span class="comment"></span>        <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classIntersectable.html#a2">intersect</a>(<span class="keyword">const</span> <a class="code" href="classRay.html">Ray</a>&amp; ray, <span class="keywordtype">float</span>&amp; depth)=0;
00083         <span class="comment"></span>
00084 <span class="comment">        //! pure virtual function, must be implemented to calculate the surface normal</span>
00085 <span class="comment"></span>        <span class="keyword">virtual</span> <a class="code" href="classVector.html">Vector</a> <a class="code" href="classIntersectable.html#a3">getShadingNormal</a>(<span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a>&amp; point)=0;
00086   <span class="comment"></span>
00087 <span class="comment">        //! index of the object in the scene array</span>
<a name="l00088"></a><a class="code" href="classIntersectable.html#m4">00088</a> <span class="comment"></span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="classIntersectable.html#m4">m_index</a>;
00089 <span class="comment"></span>
00090 <span class="comment">        //! helper to initialize m_index </span>
00091 <span class="comment"></span>        <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="classIntersectable.html#p0">gMaxIndex</a>;
00092 }; 
00093 
<a name="l00094"></a><a class="code" href="classTriangle.html">00094</a> <span class="keyword">class </span><a class="code" href="classTriangle.html">Triangle</a> : <span class="keyword">public</span> <a class="code" href="classIntersectable.html">Intersectable</a> {
00095 <span class="keyword">protected</span>:<span class="comment"></span>
00096 <span class="comment">        /*!@name Precomputed values for faster intersection testing */</span><span class="comment"></span>
00097 <span class="comment">        //@{</span>
<a name="l00098"></a><a class="code" href="classTriangle.html#z13_0">00098</a> <span class="comment"></span>        <a class="code" href="globals_8hpp.html#a13">DominantAxis</a>    <a class="code" href="classTriangle.html#z13_0">dominantAxis</a>;
<a name="l00099"></a><a class="code" href="classTriangle.html#z13_1">00099</a>         <span class="keywordtype">float</span>                   <a class="code" href="classTriangle.html#z13_1">hyperPlaneShiftOffset</a>;
<a name="l00100"></a><a class="code" href="classTriangle.html#z13_9">00100</a>         <span class="keywordtype">double</span>                  <a class="code" href="classTriangle.html#z13_2">abV1</a>, <a class="code" href="classTriangle.html#z13_3">abV2</a>, <a class="code" href="classTriangle.html#z13_4">abC</a>, <a class="code" href="classTriangle.html#z13_5">bcV1</a>, <a class="code" href="classTriangle.html#z13_6">bcV2</a>, <a class="code" href="classTriangle.html#z13_7">bcC</a>, <a class="code" href="classTriangle.html#z13_8">caV1</a>, <a class="code" href="classTriangle.html#z13_9">caV2</a>, <a class="code" href="classTriangle.html#z13_10">caC</a>; <span class="comment"></span>
00101 <span class="comment">        //@}</span>
00102 <span class="comment"></span>
00103 <span class="keyword">public</span>:<span class="comment"></span>
00104 <span class="comment">        //! the 3 vertices</span>
<a name="l00105"></a><a class="code" href="classTriangle.html#m2">00105</a> <span class="comment"></span>        <span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a>    *<a class="code" href="classTriangle.html#m0">a</a>, *<a class="code" href="classTriangle.html#m1">b</a>, *<a class="code" href="classTriangle.html#m2">c</a>;     
00106 <span class="comment"></span>
00107 <span class="comment">        //! surface normal (average of the vertices)</span>
<a name="l00108"></a><a class="code" href="classTriangle.html#m3">00108</a> <span class="comment"></span>        <a class="code" href="classVector.html">Vector</a>                  <a class="code" href="classTriangle.html#m3">normal</a>;
00109 <span class="comment"></span>
00110 <span class="comment">        //! midpoint of the triangle</span>
<a name="l00111"></a><a class="code" href="classTriangle.html#m4">00111</a> <span class="comment"></span>        <a class="code" href="classVector.html">Vector</a>                  <a class="code" href="classTriangle.html#m4">midPoint</a>;
00112 <span class="comment"></span>
00113 <span class="comment">        //! normal of the vertices</span>
<a name="l00114"></a><a class="code" href="classTriangle.html#m7">00114</a> <span class="comment"></span>        <a class="code" href="classVector.html">Vector</a>  *<a class="code" href="classTriangle.html#m5">Na</a>, *<a class="code" href="classTriangle.html#m6">Nb</a>, *<a class="code" href="classTriangle.html#m7">Nc</a>;  
00115         <span class="comment"></span>
00116 <span class="comment">        //! area of the triangle</span>
<a name="l00117"></a><a class="code" href="classTriangle.html#m8">00117</a> <span class="comment"></span>        <span class="keywordtype">float</span>                   <a class="code" href="classTriangle.html#m8">area</a>;
00118 
00119 <span class="keyword">public</span>:
<a name="l00120"></a><a class="code" href="classTriangle.html#a0">00120</a>         <a class="code" href="classTriangle.html#a0">Triangle</a>() : <a class="code" href="classIntersectable.html">Intersectable</a>(NULL) {};
00121         <a class="code" href="classTriangle.html#a0">Triangle</a>(<span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a>* a, <span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a>* b, <span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a>* c, <span class="keyword">const</span> <a class="code" href="classMaterial.html">Material</a>* material);
00122         <span class="keywordtype">bool</span> <a class="code" href="classTriangle.html#a2">intersect</a>(<span class="keyword">const</span> <a class="code" href="classRay.html">Ray</a>&amp; ray, <span class="keywordtype">float</span>&amp; depth);
00123         <a class="code" href="classVector.html">Vector</a> <a class="code" href="classTriangle.html#a3">getShadingNormal</a>(<span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a>&amp; point);
00124  
<a name="l00125"></a><a class="code" href="classTriangle.html#a4">00125</a>         <span class="keywordtype">void</span> <a class="code" href="classTriangle.html#a4">CalculateArea</a>() {
00126                 <a class="code" href="classVector.html">Vector</a> side1 = *a - *b;
00127                 <a class="code" href="classVector.html">Vector</a> side2 = *a - *c;
00128                 <a class="code" href="classVector.html">Vector</a> crossProd = side1 &amp;&amp; side2;
00129                 area = fabsf ((0.5f * crossProd.<a class="code" href="classVector.html#a18">Norm</a> ()));
00130         }
00131 <span class="comment"></span>
00132 <span class="comment">        //! Generate a random point in the triangle</span>
00133 <span class="comment"></span><span class="comment">        /*!     Point IN Triangle: barycentric parametrisation, u, v : barycentric coordinates</span>
00134 <span class="comment">        barycentric coord: to define the barycentric coordinates in R^n ( n= 2 the triangle)</span>
00135 <span class="comment">        one needs (n+1) points (3 points in 3D) that do not lie in a space of a lesser dimension. </span>
00136 <span class="comment">        From that we can find out the u,v barycentric coords.</span>
00137 <span class="comment">        here do the reverse: from u, v barycentric coords, calculate the point */</span>
<a name="l00138"></a><a class="code" href="classTriangle.html#a5">00138</a>         <a class="code" href="classVector.html">Vector</a> <a class="code" href="classTriangle.html#a5">PointInTriangle</a> () {
00139                 <span class="keywordtype">float</span> u=<a class="code" href="globals_8hpp.html#a9">RAND</a>;
00140                 <span class="keywordtype">float</span> v=<a class="code" href="globals_8hpp.html#a9">RAND</a>;
00141 
00142                 <span class="keywordflow">if</span> (u + v &gt; 1.0f) {
00143                         u = 1.0f - u; 
00144                         v = 1.0f - v;
00145                 }
00146 
00147                 <span class="keywordflow">return</span> <a class="code" href="classVector.html">Vector</a>(
00148                         a-&gt;<a class="code" href="classVector.html#m1">x</a> + u * (b-&gt;<a class="code" href="classVector.html#m1">x</a> - a-&gt;<a class="code" href="classVector.html#m1">x</a>) + v * (c-&gt;<a class="code" href="classVector.html#m1">x</a> - a-&gt;<a class="code" href="classVector.html#m1">x</a>),
00149                         a-&gt;<a class="code" href="classVector.html#m2">y</a> + u * (b-&gt;<a class="code" href="classVector.html#m2">y</a> - a-&gt;<a class="code" href="classVector.html#m2">y</a>) + v * (c-&gt;<a class="code" href="classVector.html#m2">y</a> - a-&gt;<a class="code" href="classVector.html#m2">y</a>),
00150                         a-&gt;<a class="code" href="classVector.html#m3">z</a> + u * (b-&gt;<a class="code" href="classVector.html#m3">z</a> - a-&gt;<a class="code" href="classVector.html#m3">z</a>) + v * (c-&gt;<a class="code" href="classVector.html#m3">z</a> - a-&gt;<a class="code" href="classVector.html#m3">z</a>));
00151         }
00152 
00153         <span class="keywordtype">void</span> <a class="code" href="classTriangle.html#a6">Finish</a>();
00154 };
00155 <span class="comment"></span>
00156 <span class="comment">//! Application-specific derivation of Triangle,</span>
00157 <span class="comment">//! variables specific to Stochastic Iteration are added</span>
<a name="l00158"></a><a class="code" href="classPatch.html">00158</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="classPatch.html">Patch</a> : <span class="keyword">public</span> <a class="code" href="classTriangle.html">Triangle</a> 
00159 {
00160 <span class="keyword">public</span>:<span class="comment"></span>
00161 <span class="comment">        //! true, if the patch is visible from the eye</span>
<a name="l00162"></a><a class="code" href="classPatch.html#m0">00162</a> <span class="comment"></span>        <span class="keywordtype">bool</span> <a class="code" href="classPatch.html#m0">visible</a>;
00163 <span class="comment"></span>
00164 <span class="comment">        //! count the number of screen pixels this patch is visible from</span>
<a name="l00165"></a><a class="code" href="classPatch.html#m1">00165</a> <span class="comment"></span>        <span class="keywordtype">long</span> <a class="code" href="classPatch.html#m1">nScreenPixel</a>;
00166 
00167 <span class="keyword">public</span>:<span class="comment"></span>
00168 <span class="comment">        //! diffuse part of the radiance</span>
00169 <span class="comment">        //! sum (I * f_d), where f_d is the main (diffuse) part of the BRDF function</span>
<a name="l00170"></a><a class="code" href="classPatch.html#m2">00170</a> <span class="comment"></span>        <a class="code" href="classVector.html">Color</a>           <a class="code" href="classPatch.html#m2">Ld</a>;
00171 <span class="comment"></span>
00172 <span class="comment">        //! scale factor for specular irradiance</span>
00173 <span class="comment">        //! sum Lum(I*d_a), where d_a is the specular albedo</span>
<a name="l00174"></a><a class="code" href="classPatch.html#m3">00174</a> <span class="comment"></span>        <span class="keywordtype">float</span>   <a class="code" href="classPatch.html#m3">C_I</a>;
00175 <span class="comment"></span>
00176 <span class="comment">        //! last accepted irradiance</span>
<a name="l00177"></a><a class="code" href="classPatch.html#m4">00177</a> <span class="comment"></span>        <a class="code" href="classVector.html">Color</a>           <a class="code" href="classPatch.html#m4">I</a>;<span class="comment"></span>
00178 <span class="comment">        //! direction of the last accepted irradiance</span>
<a name="l00179"></a><a class="code" href="classPatch.html#m5">00179</a> <span class="comment"></span>        <a class="code" href="classVector.html">Vector</a>  <a class="code" href="classPatch.html#m5">dirI</a>;
00180 
00181 <span class="comment"></span>
00182 <span class="comment">        //! diffuse part of the importance</span>
00183 <span class="comment">        //! sum (W * f_d), where f_d is the main (diffuse) part of the BRDF function</span>
<a name="l00184"></a><a class="code" href="classPatch.html#m6">00184</a> <span class="comment"></span>        <span class="keywordtype">float</span>   <a class="code" href="classPatch.html#m6">Rd</a>;
00185 <span class="comment"></span>
00186 <span class="comment">        //! scale factor for specular importance</span>
00187 <span class="comment">        //! sum Lum(W*d_a), where d_a is the specular albedo</span>
<a name="l00188"></a><a class="code" href="classPatch.html#m7">00188</a> <span class="comment"></span>        <span class="keywordtype">float</span>   <a class="code" href="classPatch.html#m7">C_W</a>;
00189 <span class="comment"></span>
00190 <span class="comment">        //! last accepted importance</span>
<a name="l00191"></a><a class="code" href="classPatch.html#m8">00191</a> <span class="comment"></span>        <span class="keywordtype">float</span>   <a class="code" href="classPatch.html#m8">W</a>;
00192 <span class="comment"></span>
00193 <span class="comment">        //! direction of the last accepted importance</span>
<a name="l00194"></a><a class="code" href="classPatch.html#m9">00194</a> <span class="comment"></span>        <a class="code" href="classVector.html">Vector</a>  <a class="code" href="classPatch.html#m9">dirW</a>;
00195 
00196 <span class="comment"></span>
00197 <span class="comment">        //! precomputed value; patch --&gt; eye direction</span>
<a name="l00198"></a><a class="code" href="classPatch.html#m10">00198</a> <span class="comment"></span>        <a class="code" href="classVector.html">Vector</a>  <a class="code" href="classPatch.html#m10">m_VisDir</a>;
00199 <span class="comment"></span>
00200 <span class="comment">        //! precomputed value; eye --&gt; patch direction</span>
<a name="l00201"></a><a class="code" href="classPatch.html#m11">00201</a> <span class="comment"></span>        <a class="code" href="classVector.html">Vector</a>  <a class="code" href="classPatch.html#m11">m_EyePatchDir</a>;
00202 <span class="comment"></span>
00203 <span class="comment">        //! sum radiance towards the eye</span>
00204 <span class="comment">        //! Leye = sum(I * f_eye)</span>
<a name="l00205"></a><a class="code" href="classPatch.html#m12">00205</a> <span class="comment"></span>        <a class="code" href="classVector.html">Color</a>           <a class="code" href="classPatch.html#m12">Leye</a>;
00206 
<a name="l00207"></a><a class="code" href="classPatch.html#m13">00207</a>         <a class="code" href="classVector.html">Color</a>           <a class="code" href="classPatch.html#m13">Leye_s</a>;
<a name="l00208"></a><a class="code" href="classPatch.html#m14">00208</a>         <span class="keywordtype">float</span>           <a class="code" href="classPatch.html#m14">d</a>;
<a name="l00209"></a><a class="code" href="classPatch.html#m15">00209</a>         <span class="keywordtype">long</span>            <a class="code" href="classPatch.html#m15">iteration</a>;
00210 
00211 <span class="keyword">public</span>:
<a name="l00212"></a><a class="code" href="classPatch.html#a0">00212</a>         <span class="keywordtype">void</span> <a class="code" href="classPatch.html#a0">Reset</a>() {
00213                 visible=<span class="keyword">false</span>;
00214                 nScreenPixel=0;
00215                 I = Ld = Leye = Color::BLACK;
00216                 W = C_W = Rd = C_I = 0.0f;
00217 
00218                 Leye_s = Color::BLACK;
00219                 d = 0.0f;
00220 
00221                 iteration = 0;
00222         }
00223 <span class="comment"></span>
00224 <span class="comment">        //! simple triangle plane -- ray intersection calculation</span>
00225 <span class="comment"></span>        <span class="keywordtype">bool</span> <a class="code" href="classPatch.html#a1">CalculateIntersection</a> (<span class="keyword">const</span> <a class="code" href="classRay.html">Ray</a>&amp; ray, <a class="code" href="classHitRec.html">HitRec</a>&amp; hr);
00226 };
00227 
00228 <span class="keyword">class </span><a class="code" href="classLight.html">Light</a>;
00229 <span class="comment"></span>
00230 <span class="comment">//! Precalclate and store a given number of point samples on area light sources</span>
<a name="l00231"></a><a class="code" href="classLightSourceSample.html">00231</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="classLightSourceSample.html">LightSourceSample</a> {
00232 <span class="keyword">public</span>:
<a name="l00233"></a><a class="code" href="classLightSourceSample.html#m0">00233</a>         <a class="code" href="classLight.html">Light</a>* <a class="code" href="classLightSourceSample.html#m0">m_pLight</a>;
<a name="l00234"></a><a class="code" href="classLightSourceSample.html#m1">00234</a>         <span class="keywordtype">int</span> <a class="code" href="classLightSourceSample.html#m1">m_nSamples</a>;
<a name="l00235"></a><a class="code" href="classLightSourceSample.html#m2">00235</a>         <a class="code" href="classVector.html">Vector</a>* <a class="code" href="classLightSourceSample.html#m2">samples</a>;
00236 
00237 <span class="keyword">public</span>:
<a name="l00238"></a><a class="code" href="classLightSourceSample.html#a0">00238</a>         <a class="code" href="classLightSourceSample.html#a0">LightSourceSample</a>(<a class="code" href="classLight.html">Light</a>* light=NULL, <span class="keywordtype">int</span> nSamples=0) : samples(NULL) { <a class="code" href="classLightSourceSample.html#a2">Init</a>(light, nSamples); };
<a name="l00239"></a><a class="code" href="classLightSourceSample.html#a1">00239</a>         <a class="code" href="classLightSourceSample.html#a1">~LightSourceSample</a>() { <span class="keywordflow">if</span> (samples) <span class="keyword">delete</span> samples; }
00240 <span class="comment"></span>
00241 <span class="comment">        //! Generate lightsource samples</span>
00242 <span class="comment"></span>        <span class="keywordtype">void</span> <a class="code" href="classLightSourceSample.html#a2">Init</a>(<a class="code" href="classLight.html">Light</a>* light, <span class="keywordtype">int</span> nSamples);
00243 };
00244 <span class="comment"></span>
00245 <span class="comment">//! Assign emissive patches and LightSourceSample</span>
<a name="l00246"></a><a class="code" href="classLight.html">00246</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="classLight.html">Light</a> 
00247 {
00248 <span class="keyword">public</span>:
<a name="l00249"></a><a class="code" href="classLight.html#m0">00249</a>         <a class="code" href="classPatch.html">Patch</a>*  <a class="code" href="classLight.html#m0">m_pPatch</a>;
<a name="l00250"></a><a class="code" href="classLight.html#m1">00250</a>         <a class="code" href="classLightSourceSample.html">LightSourceSample</a>*      <a class="code" href="classLight.html#m1">m_pSamples</a>;
00251 
00252 <span class="keyword">public</span>:
<a name="l00253"></a><a class="code" href="classLight.html#a0">00253</a>         <a class="code" href="classLight.html#a0">Light</a>() {};
<a name="l00254"></a><a class="code" href="classLight.html#a1">00254</a>         <span class="keywordtype">void</span> <a class="code" href="classLight.html#a1">Init</a>(<a class="code" href="classPatch.html">Patch</a>* pPatch, <span class="keywordtype">int</span> nSamples=2) { 
00255                 m_pPatch = pPatch;
00256                 m_pSamples = <span class="keyword">new</span> <a class="code" href="classLightSourceSample.html">LightSourceSample</a>(<span class="keyword">this</span>, nSamples);
00257         }
<a name="l00258"></a><a class="code" href="classLight.html#a2">00258</a>         <a class="code" href="classLight.html#a2">~Light</a>() { <span class="keyword">delete</span> m_pSamples; }
00259 };
</pre></div><hr><address style="align: right;"><small>Generated on Tue Feb 18 18:30:35 2003 for Stochastic Iteration for Non-diffuse Global Illumination by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc2 </small></address>
</body>
</html>
